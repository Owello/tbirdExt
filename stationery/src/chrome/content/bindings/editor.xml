<?xml version="1.0"?>
<!-- *-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*
project: "Stationery" extension for Thunderbird
filename: editor.xml
author: Łukasz 'Arivald' Płomiński <arivald@interia.pl>
description: binding file to extend <editor>, primarly to allow it working with findbar
  
  This file extends "chrome://global/content/bindings/editor.xml", and
  uses parts of code from there. Original file is under Mozilla Public License.
  
*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-* -->

<bindings id="stationeryEditorBindings"
          xmlns="http://www.mozilla.org/xbl"
          xmlns:xbl="http://www.mozilla.org/xbl"
          xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">

  <binding id="editor"
           extends="chrome://global/content/bindings/editor.xml#editor">
           
    <implementation type="application/javascript">
      <!-- findbar support -->
      <!-- code copied from browser.xml with minor changes -->
      <field name="_fastFind">null</field>
      <property name="fastFind" readonly="true">
        <getter>
        <![CDATA[
          try {
            if (!this._fastFind) {
              if (!("@mozilla.org/typeaheadfind;1" in Components.classes))
                return null;

              if (!this.docShell)
                return null;
              this._fastFind = Components.classes["@mozilla.org/typeaheadfind;1"]
                                         .createInstance(Components.interfaces.nsITypeAheadFind);                                
              this._fastFind.init(this.docShell);
            }
            return this._fastFind;
          } catch(e) { }
        ]]>
        </getter>
      </property>
      
      <!-- new "finder" findbar support -->
      <!-- code copied from browser.xml with minor changes -->
      <field name="_finder">null</field>
      <property name="finder" readonly="true">
         <getter><![CDATA[
          try{
            if (!this._finder) {
              if (!this.docShell) return null;
              let Finder = Components.utils.import("resource://gre/modules/Finder.jsm", {}).Finder;
              this._finder = new Finder(this.docShell);
            }
            return this._finder;
          } catch(e) { }
        ]]></getter>
      </property>               
      
      <property name="currentURI"
                onget="return this.webNavigation.currentURI;"
                readonly="true"/>
      <!-- end of finbar support --> 
    </implementation>
  </binding>
</bindings>
